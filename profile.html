<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Профиль | ReviewCash</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --bg:#0a0a14; --neon:#00ffff; --success:#00ff88; --danger:#ff3366; --gold:#ffd700; --glass:rgba(20,20,38,0.6); --border:rgba(0,255,255,0.3); }
    * { margin:0; padding:0; box-sizing:border-box; }
    body { background:var(--bg); color:#e0f7ff; font-family:'Inter',sans-serif; overflow:hidden; opacity:0; transition:opacity .8s ease; }
    body.loaded { opacity:1; }

    /* СПЛЕШ-ЭКРАН */
    .splash { position:fixed; top:0; left:0; width:100%; height:100%; z-index:9999; background:#000; display:flex; flex-direction:column; justify-content:center; align-items:center; }
    .logo-anim { width:180px; height:180px; background:url('https://i.ibb.co/9bT3vP8/reviewcash-v2-neon-2025.png') center/contain no-repeat; filter:drop-shadow(0 0 80px #00ffff); animation:float 3s ease-in-out infinite, glow 2s ease-in-out infinite alternate; }
    .title-anim { font-family:'Orbitron',sans-serif; font-size:48px; font-weight:900; margin-top:30px; background:linear-gradient(90deg,#00ffff,#00ff88,#ff00ff); -webkit-background-clip:text; -webkit-text-fill-color:transparent; animation:glitch 2s infinite; }
    .particles { position:absolute; width:100%; height:100%; pointer-events:none; }
    .particle { position:absolute; width:6px; height:6px; background:#00ffff; border-radius:50%; opacity:0; animation:explode 2s ease-out forwards; }
    @keyframes float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-25px)} }
    @keyframes glow { from{filter:drop-shadow(0 0 80px #00ffff)} to{filter:drop-shadow(0 0 140px #00ff88)} }
    @keyframes glitch { 0%,100%{text-shadow:0 0 20px #00ffff} 10%{text-shadow:5px 0 #ff00ff,-5px 0 #00ff88} 20%{text-shadow:-5px 0 #ff00ff,5px 0 #00ffff} }
    @keyframes explode { 0%{transform:scale(0);opacity:0} 50%{opacity:1} 100%{transform:translate(var(--x),var(--y)) scale(0);opacity:0} }

    .bg-animation { position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:-1; background:linear-gradient(45deg,#0a0a14,#141426); }
    .bg-animation::before { content:''; position:absolute; top:-50%; left:-50%; width:200%; height:200%; background:repeating-conic-gradient(from 0deg,transparent 0deg,rgba(0,255,255,0.03) 1deg,transparent 2deg); animation:rotate 30s linear infinite; }
    @keyframes rotate { to{transform:rotate(360deg)} }

    .container { max-width:420px; margin:20px auto; padding:0 16px; }
    .profile-card { background:var(--glass); backdrop-filter:blur(16px); border:1px solid var(--border); border-radius:28px; padding:28px; box-shadow:0 20px 40px rgba(0,0,0,0.4); }
    .header h1 { font-family:'Orbitron',sans-serif; font-size:26px; font-weight:900; background:linear-gradient(90deg,#00ffff,#00ff88); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
    .status { background:linear-gradient(45deg,var(--success),#00cc66); color:white; padding:6px 12px; border-radius:20px; font-size:11px; font-weight:bold; }
    .avatar { width:90px; height:90px; border-radius:50%; border:4px solid var(--neon); box-shadow:0 0 30px rgba(0,255,255,0.3); }
    .balance-card { background:linear-gradient(135deg,#1e3c72,#2a5298); border-radius:24px; padding:24px; text-align:center; margin:20px 0; border:1px solid rgba(0,255,255,0.3); }
    .balance-amount { font-family:'Orbitron',sans-serif; font-size:36px; font-weight:900; background:linear-gradient(90deg,#00ffff,#00ff88); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
    .btn { padding:18px; border:none; border-radius:20px; font-weight:700; font-size:17px; cursor:pointer; text-transform:uppercase; letter-spacing:1px; width:100%; }
    .btn-topup { background:linear-gradient(45deg,var(--success),#00cc66); color:white; }
    .btn-withdraw { background:linear-gradient(45deg,var(--danger),#ff1a50); color:white; }
    .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:1000; justify-content:center; align-items:center; padding:20px; backdrop-filter:blur(20px); }
    .modal.active { display:flex; }
    .modal-content { background:var(--glass); border:2px solid var(--neon); border-radius:32px; padding:40px 32px; max-width:460px; text-align:center; box-shadow:0 0 120px rgba(0,255,255,0.7); position:relative; }
    .close-modal { position:absolute; top:16px; right:16px; color:var(--neon); font-size:32px; background:none; border:none; cursor:pointer; }
    .code { font-family:'Orbitron',monospace; font-size:42px; font-weight:900; color:var(--gold); letter-spacing:8px; background:rgba(0,0,0,0.5); padding:24px 16px; border-radius:24px; margin:24px 0; cursor:pointer; text-align:center; word-break:break-all; border:2px solid rgba(255,215,0,0.4); box-shadow:0 0 30px rgba(255,215,0,0.3); }
    @media (max-width:380px) { .code { font-size:38px !important; letter-spacing:6px; } }

    .bottom-nav { position:fixed; bottom:20px; left:20px; right:20px; background:rgba(20,20,38,0.9); backdrop-filter:blur(20px); border:2px solid rgba(0,255,255,0.3); border-radius:30px; padding:8px; display:flex; justify-content:space-around; box-shadow:0 15px 40px rgba(0,0,0,0.6); z-index:999; }
    .nav-btn { flex:1; padding:16px 24px; border:none; border-radius:25px; font-weight:800; font-size:18px; cursor:pointer; transition:all .4s cubic-bezier(.25,.8,.25,1); background:transparent; color:#88c0d0; position:relative; overflow:hidden; }
    .nav-btn.active { background:linear-gradient(45deg,#00ffff,#00ff88); color:#000; box-shadow:0 0 40px rgba(0,255,255,0.8); transform:translateY(-4px); }
    .nav-btn::before { content:''; position:absolute; top:0; left:-100%; width:100%; height:100%; background:linear-gradient(90deg,transparent,rgba(255,255,255,0.3),transparent); transition:.6s; }
    .nav-btn:hover::before { left:100%; }
  </style>
</head>
<body>
  <div class="splash" id="splash">
    <div class="logo-anim"></div>
    <div class="title-anim">REVIEWCASH</div>
    <div class="particles" id="particles"></div>
  </div>

  <div class="bg-animation"></div>
  <div class="container">
    <div class="profile-card">
      <div class="header"><h1>ПРОФИЛЬ</h1><div class="status">ПРЕМИУМ</div></div>
      <div style="text-align:center;margin:20px 0;">
        <img id="avatar" src="" class="avatar">
        <div style="margin-top:10px;font-size:20px;font-weight:700;" id="username">@User</div>
      </div>
      <div class="balance-card">
        <div style="font-size:14px;color:#88c0d0;">БАЛАНС</div>
        <div class="balance-amount"><span id="balance">0.00</span> ₽</div>
        <button onclick="fetchBalance()" style="margin-top:10px;padding:10px 20px;background:rgba(255,255,255,0.15);border:1px solid rgba(255,255,255,0.3);border-radius:16px;color:white;">Обновить</button>
      </div>
      <button class="btn btn-topup" onclick="openTopup()">ПОПОЛНИТЬ</button>
      <button class="btn btn-withdraw" onclick="openWithdraw()">ВЫВОД</button>
    </div>
  </div>

  <div id="topup-modal" class="modal">
    <div class="modal-content">
      <button class="close-modal" onclick="closeTopup()">×</button>
      <h2 style="color:var(--neon);font-size:32px;">Пополнение</h2>
      <input type="number" id="topup-amount" placeholder="Сумма (мин. 100 ₽)" min="100">
      <div id="topup-details" style="display:none;">
        <p>Переведи <b>ровно</b> на телефон:</p>
        <div style="background:rgba(255,255,255,0.05);padding:24px;border-radius:20px;border:1px solid var(--border);font-size:20px;text-align:center;">
          <p><b>Номер:</b> +7 (960) 073-85-59</p>
          <p><b>Имя:</b> Раяз Н.</p>
          <p><b>Банк:</b> Т-Банк (Тинькофф)</p>
        </div>
        <p style="margin:20px 0 10px;">В комментарии напиши код:</p>
        <div class="code" id="topup-code" onclick="copyCode(this)">000000</div>
        <p style="color:var(--success);font-weight:900;margin-top:20px;">Я увижу перевод → зачислю за 1–5 минут!</p>
      </div>
      <button class="btn btn-topup" onclick="sendTopesthesiology()">ОТПРАВИТЬ ЗАЯВКУ</button>
    </div>
  </div>

  <div id="withdraw-modal" class="modal">
    <div class="modal-content">
      <button class="close-modal" onclick="closeWithdraw()">×</button>
      <h2 style="color:var(--danger);font-size:32px;">Вывод на банк</h2>
      <input type="text" id="withdraw-method" placeholder="Карта или телефон">
      <input type="text" id="withdraw-fio" placeholder="ФИО или ник">
      <input type="text" id="withdraw-bank" placeholder="Банк">
      <input type="number" id="withdraw-amount" placeholder="Сумма (мин. 500 ₽)" min="500">
      <button class="btn btn-withdraw" onclick="sendWithdraw()">ОТПРАВИТЬ ЗАЯВКУ</button>
    </div>
  </div>

  <div class="bottom-nav">
    <button class="nav-btn nav-tasks" onclick="location.href='index.html'">Задания</button>
    <button class="nav-btn nav-profile active">Профиль</button>
  </div>

  <script>
    const tg = window.Telegram.WebApp;
    tg.ready(); tg.expand();

    // ЧАСТИЦЫ
    const particles = document.getElementById('particles');
    for(let i=0;i<40;i++){
      const p=document.createElement('div');
      p.classList.add('particle');
      p.style.setProperty('--x',(Math.random()-0.5)*1000+'px');
      p.style.setProperty('--y',(Math.random()-0.5)*1000+'px');
      p.style.animationDelay=Math.random()*1.5+'s';
      particles.appendChild(p);
    }

    // УБИРАЕМ СПЛЕШ
    setTimeout(()=>{
      document.getElementById('splash').style.opacity = '0';
      document.getElementById('splash').style.transition = 'opacity 0.5s';
      setTimeout(()=>{ document.getElementById('splash').remove(); document.body.classList.add('loaded'); }, 500);
    }, 2400);

    // ОСНОВНОЙ СКРИПТ
    document.getElementById('avatar').src = tg.initDataUnsafe.user?.photo_url || 'https://via.placeholder.com/90/00ffff/000000?text=RC';
    document.getElementById('username').innerText = '@'+(tg.initDataUnsafe.user?.username||'User');

    function fetchBalance(){ document.getElementById('balance').innerText='...'; tg.sendData(JSON.stringify({action:"get_balance"})); }
    function copyCode(el){ navigator.clipboard.writeText(el.innerText); tg.showAlert("Код скопирован!"); }

    tg.onEvent('webAppDataReceived',data=>{ try{ const res=JSON.parse(data);
      if(res.balance!==undefined) document.getElementById('balance').innerText=res.balance.toFixed(2);
      if(res.success){ tg.showAlert("Заявка отправлена!"); closeTopup(); closeWithdraw(); fetchBalance(); }
    }catch(e){} });

    function openTopup(){ document.getElementById('topup-modal').classList.add('active'); }
    function closeTopup(){ document.getElementById('topup-modal').classList.remove('active'); document.getElementById('topup-details').style.display='none'; }
    function sendTopup(){
      const amount=parseFloat(document.getElementById('topup-amount').value);
      if(!amount||amount<100) return tg.showAlert("Минимум 100 ₽");
      const code=Math.floor(100000+Math.random()*900000);
      document.getElementById('topup-code').innerText=code;
      document.getElementById('topup-details').style.display='block';
      tg.sendData(JSON.stringify({action:"request_topup",amount,code}));
    }

    function openWithdraw(){ document.getElementById('withdraw-modal').classList.add('active'); }
    function closeWithdraw(){ document.getElementById('withdraw-modal').classList.remove('active'); }
    function sendWithdraw(){
      const method=document.getElementById('withdraw-method').value.trim();
      const fio=document.getElementById('withdraw-fio').value.trim();
      const bank=document.getElementById('withdraw-bank').value.trim();
      const amount=parseFloat(document.getElementById('withdraw-amount').value);
      if(!method||!fio||!bank||!amount||amount<500) return tg.showAlert("Заполни все поля! Мин. 500 ₽");
      tg.sendData(JSON.stringify({action:"request_withdraw",method,fio,bank,amount}));
    }

    document.querySelectorAll('.nav-btn').forEach(b=>b.addEventListener('click',()=>{ document.querySelectorAll('.nav-btn').forEach(x=>x.classList.remove('active')); b.classList.add('active'); }));

    window.onload=()=>{ fetchBalance(); setInterval(fetchBalance,10000); };
  </script>
</body>
</html>
