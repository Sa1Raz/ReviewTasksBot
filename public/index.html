<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ReviewCash — Империя отзывов</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
  <style>
    :root{--bg:#0a0014;--glass:rgba(15,10,45,0.98);--neon:#00ffff;--green:#00ff88;--gold:#ffd700;--danger:#ff3366;--border:rgba(0,255,255,0.6);--text:#e0f7ff;--muted:#88c0d0;}
    *{margin:0;padding:0;box-sizing:border-box;}
    body{background:linear-gradient(135deg,#0a0014,#001133);color:var(--text);font-family:-apple-system,system-ui,sans-serif;min-height:100vh;overflow-x:hidden;}
    .container{max-width:420px;margin:0 auto;padding:16px 16px 140px;position:relative;}
    .header h1{font-size:38px;font-weight:900;text-align:center;padding:30px 0 10px;background:linear-gradient(90deg,#00ffff,#00ff88,#ffd700);-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:0 0 40px rgba(0,255,255,0.6);}
    .support-btn{position:absolute;top:16px;right:16px;width:48px;height:48px;background:rgba(0,136,204,0.3);border:2.5px solid var(--neon);border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 0 35px rgba(0,255,255,0.5);backdrop-filter:blur(12px);z-index:1000;}
    .support-btn i{font-size:24px;color:#00ffff;}
    .role-switch{display:flex;background:rgba(20,20,50,0.9);border:3px solid var(--border);border-radius:32px;padding:8px;margin:20px 0;backdrop-filter:blur(20px);}
    .role-btn{flex:1;padding:16px;border-radius:26px;font-weight:900;font-size:15.5px;text-align:center;color:var(--muted);cursor:pointer;transition:.5s;}
    .role-btn.active{background:linear-gradient(135deg,var(--neon),var(--green));color:#000;box-shadow:0 0 60px rgba(0,255,255,0.8);transform:translateY(-4px);}
    .create-btn{width:100%;padding:26px;background:linear-gradient(45deg,#ffd700,#ff8c00);color:#000;border:none;border-radius:32px;font-size:24px;font-weight:900;margin:20px 0;cursor:pointer;box-shadow:0 15px 50px rgba(255,215,0,0.6);text-transform:uppercase;letter-spacing:1.5px;}
    .create-form{background:var(--glass);border:3px solid var(--neon);border-radius:32px;padding:28px;margin:20px 0;display:none;backdrop-filter:blur(25px);box-shadow:0 20px 60px rgba(0,255,255,0.3);}
    .create-form.active{display:block;animation:slideDown .6s;}
    @keyframes slideDown{from{opacity:0;transform:translateY(-30px)}to{opacity:1;transform:translateY(0)}}
    input,select{width:100%;padding:18px;margin:14px 0;background:rgba(0,0,0,0.7);border:3px solid var(--neon);border-radius:20px;color:white;font-size:16px;font-weight:600;}
    .price-buttons{display:flex;gap:12px;overflow-x:auto;padding:16px 0;scrollbar-width:none;margin:20px 0;}
    .price-btn{padding:16px 26px;background:rgba(0,255,255,0.15);border:3px solid var(--neon);border-radius:30px;color:white;font-weight:900;font-size:15px;cursor:pointer;min-width:115px;text-align:center;transition:.4s;white-space:nowrap;}
    .price-btn.active{background:var(--neon);color:#000;transform:scale(1.15);box-shadow:0 0 80px #00ffff;}
    .budget-result{background:linear-gradient(135deg,rgba(0,255,136,0.25),rgba(0,255,255,0.25));padding:26px;border-radius:24px;text-align:center;margin:20px 0;border:3px solid var(--green);font-size:20px;font-weight:900;color:var(--gold);line-height:1.5;min-height:85px;}
    .submit-create{width:100%;padding:26px;background:linear-gradient(45deg,var(--green),#00cc66);color:black;border:none;border-radius:32px;font-size:24px;font-weight:900;margin-top:30px;cursor:pointer;text-transform:uppercase;}
    .filter-bar{display:flex;gap:16px;padding:20px 16px;overflow-x:auto;scrollbar-width:none;margin:20px 0;background:rgba(20,20,50,0.9);border-radius:32px;border:3px solid var(--border);backdrop-filter:blur(20px);}
    .filter-btn{padding:16px 26px;background:rgba(0,255,255,0.15);border:3px solid var(--neon);border-radius:30px;color:white;font-weight:900;display:flex;flex-direction:column;align-items:center;gap:8px;min-width:90px;cursor:pointer;transition:.4s;}
    .filter-btn i{font-size:28px;}
    .filter-btn span{font-size:13px;}
    .filter-btn.active{background:var(--neon);color:#000;transform:scale(1.15);box-shadow:0 0 80px #00ffff;}
    .profile-avatar{width:130px;height:130px;border-radius:50%;border:6px solid var(--neon);box-shadow:0 0 80px rgba(0,255,255,0.9);object-fit:cover;margin:20px auto;display:block;}
    .balance{font-size:56px;font-weight:900;color:var(--green);text-shadow:0 0 30px rgba(0,255,136,0.7);text-align:center;}
    .bottom-nav{position:fixed;bottom:20px;left:20px;right:20px;background:rgba(15,15,45,0.98);backdrop-filter:blur(30px);border:4px solid var(--border);border-radius:40px;padding:12px;display:flex;box-shadow:0 50px 100px rgba(0,0,0,0.9);z-index:999;}
    .nav-btn{flex:1;padding:20px;border:none;border-radius:32px;font-weight:900;font-size:18px;background:transparent;color:var(--muted);transition:.5s;}
    .nav-btn.active{background:linear-gradient(45deg,var(--neon),var(--green));color:#000;transform:translateY(-8px);box-shadow:0 0 70px rgba(0,255,255,0.9);}
    .copy-block{background:rgba(0,255,255,0.12);border:2px dashed var(--neon);border-radius:20px;padding:22px;margin:18px 0;text-align:center;cursor:pointer;transition:all .3s;user-select:none;}
    .copy-block:hover{background:rgba(0,255,255,0.25);transform:scale(1.03);}
    .copy-block:active{transform:scale(0.98);}
    .copy-text{font-size:32px;font-weight:900;color:var(--gold);letter-spacing:1px;}
    .copy-hint{font-size:15px;color:var(--muted);margin-top:6px;}
    .important{color:#ff3366;font-weight:900;font-size:18px;}
  </style>
</head>
<body>

<div id="main-page" class="container">
  <div class="header"><h1>REVIEWCASH</h1></div>

  <div class="role-switch">
    <div class="role-btn active" data-role="employer">РАБОТОДАТЕЛЬ</div>
    <div class="role-btn" data-role="worker">ИСПОЛНИТЕЛЬ</div>
  </div>

  <div id="employer-mode">
    <button class="create-btn" id="create-task-btn">+ СОЗДАТЬ НОВОЕ ЗАДАНИЕ</button>

    <div class="create-form" id="create-form">
      <input type="text" id="task-title" placeholder="Например: 5 звёзд в Яндекс.Картах">
      <input type="url" id="task-link" placeholder="https://example.com">
      <select id="task-type">
        <option value="">Выберите тип</option>
        <option value="yandex">Яндекс Отзыв (100 ₽)</option>
        <option value="google">Google Отзыв (65 ₽)</option>
        <option value="telegram">Telegram Подписка (10 ₽)</option>
      </select>
      <input type="number" id="task-budget" placeholder="До 15 000 ₽" min="100" max="15000">

      <div class="price-buttons">
        <div class="price-btn" data-amount="500">500 ₽</div>
        <div class="price-btn" data-amount="1000">1000 ₽</div>
        <div class="price-btn" data-amount="3000">3000 ₽</div>
        <div class="price-btn" data-amount="5000">5000 ₽</div>
        <div class="price-btn" data-amount="10000">10 000 ₽</div>
        <div class="price-btn" data-amount="15000">15 000 ₽</div>
      </div>

      <div class="budget-result" id="budget-result">Выберите тип и сумму</div>
      <button class="submit-create" id="publish-task">ОПУБЛИКОВАТЬ ЗАДАНИЕ</button>
    </div>
  </div>

  <div id="worker-mode" style="display:none;">
    <div class="filter-bar">
      <div class="filter-btn active"><i class="fas fa-th-large"></i><span>ВСЕ</span></div>
      <div class="filter-btn"><i class="fab fa-yandex"></i><span>ЯНДЕКС</span></div>
      <div class="filter-btn"><i class="fab fa-google"></i><span>GOOGLE</span></div>
      <div class="filter-btn"><i class="fab fa-telegram"></i><span>TG</span></div>
    </div>
    <div style="text-align:center;padding:100px;color:#888;"><h2>Задания скоро появятся</h2></div>
  </div>
</div>

<div id="profile-page" class="container" style="display:none;position:relative;">
  <div class="support-btn" onclick="tg.openTelegramLink('https://t.me/RapiHappy')">
    <i class="fas fa-headset"></i>
  </div>

  <div style="text-align:center;padding:40px 0;">
    <img id="user-avatar" class="profile-avatar" src="" alt="Аватар">
    <h2 style="color:white;margin:15px 0;font-size:26px;" id="user-name">Загрузка...</h2>
    <p style="color:#88c0d0;font-size:16px;" id="user-username">@username</p>
  </div>

  <div style="background:var(--glass);border:3px solid var(--neon);border-radius:32px;padding:30px;margin:20px 0;text-align:center;backdrop-filter:blur(20px);">
    <div class="balance" id="user-balance">0 ₽</div>
    <p style="margin-top:10px;color:#aaa;">Доступно для вывода</p>
  </div>

  <button class="create-btn" style="background:linear-gradient(45deg,#00cc66,#00ff88);" id="topup-btn">ПОПОЛНИТЬ БАЛАНС</button>
  <button class="create-btn" style="background:linear-gradient(45deg,#ff3366,#ff1a50);margin-top:15px;" id="withdraw-btn">ВЫВОД СРЕДСТВ</button>
</div>

<div class="bottom-nav">
  <button class="nav-btn active" data-page="main">Задания</button>
  <button class="nav-btn" data-page="profile">Профиль</button>
</div>

<script>
  const tg = window.Telegram.WebApp;
  tg.ready(); tg.expand();
  const user = tg.initDataUnsafe.user || {};
  const prices = { yandex: 100, google: 65, telegram: 10 };
  const minBudget = { yandex: 100, google: 65, telegram: 10 };
  let userBalance = 0;

  // Аватар и данные из Telegram
  document.getElementById('user-name').innerText = user.first_name || 'Пользователь';
  document.getElementById('user-username').innerText = user.username ? '@' + user.username : '—';
  document.getElementById('user-avatar').src = user.photo_url || 'https://api.dicebear.com/7.x/avataaars/svg?seed=' + (user.id || 'user');
  document.getElementById('user-balance').innerText = userBalance.toLocaleString() + ' ₽';

  // Копирование по клику
  function copyToClip(text) {
    navigator.clipboard.writeText(text);
    tg.showAlert("Скопировано!");
  }

  // ПОПОЛНЕНИЕ — ТОЧНО ПО ТВОЕЙ СХЕМЕ
  document.getElementById('topup-btn').onclick = () => {
    tg.showPopup({
      title: "Пополнение баланса",
      message: '<div style="padding:20px;text-align:center;"><input type="number" id="topupAmount" placeholder="от 100 ₽" style="width:100%;padding:18px;margin:15px 0;background:#000;border:3px solid #00ffff;border-radius:20px;color:white;font-size:18px;text-align:center;"><button id="topupNext" style="width:100%;padding:18px;background:#00ff88;color:black;border:none;border-radius:20px;font-weight:900;margin-top:10px;">ДАЛЕЕ</button></div>',
      buttons: [{type:"close"}]
    });

    setTimeout(() => {
      document.getElementById('topupNext').onclick = () => {
        const amount = parseInt(document.getElementById('topupAmount').value || 0);
        if (amount < 100) return tg.showAlert("Минимум 100 ₽");

        const code = "RC" + Math.floor(1000 + Math.random() * 9000);

        tg.showPopup({
          title: "ПЕРЕВОД НА ТЕЛЕФОН",
          message: `<div style="padding:20px;text-align:center;line-height:1.7;font-size:18px;">
            <p>Переведи ровно <b style="color:#00ff88;font-size:28px;">${amount} ₽</b></p>
            <div class="copy-block" onclick="copyToClip('+79600738559')">
              <div class="copy-text">+7 960 073 85 59</div>
              <div class="copy-hint">Нажми — скопируется</div>
            </div>
            <p style="margin:15px 0;"><b>Получатель: РАЯЗ Н.</b></p>
            <p class="important">В КОММЕНТАРИИ ОБЯЗАТЕЛЬНО УКАЖИ:</p>
            <div class="copy-block" onclick="copyToClip('${code}')">
              <div class="copy-text">${code}</div>
              <div class="copy-hint">Нажми — скопируется код</div>
            </div>
            <button onclick="tg.showConfirm('Ты отправил ${amount} ₽ с кодом ${code}?', ok=>{if(ok) tg.showAlert('Заявка принята! Зачислят в течение 5-30 минут');})" 
                    style="margin-top:25px;width:100%;padding:20px;background:#00ff88;color:black;border:none;border-radius:20px;font-weight:900;font-size:20px;">
              Я ПЕРЕВЁЛ ДЕНЬГИ
            </button>
          </div>`,
          buttons: [{type:"close"}]
        });
      };
    }, 400);
  };

  // ВЫВОД
  document.getElementById('withdraw-btn').onclick = () => {
    tg.showPopup({
      title: "Вывод средств",
      message: `<div style="padding:20px;text-align:center;">
        <p style="color:#aaa;">Доступно: <b style="color:#00ff88;font-size:26px;">${userBalance.toLocaleString()} ₽</b></p>
        <input type="number" id="wAmount" placeholder="от 100 ₽" style="width:100%;padding:18px;margin:15px 0;background:#000;border:3px solid #ff3366;border-radius:20px;color:white;font-size:18px;text-align:center;">
        <button id="wNext" style="width:100%;padding:18px;background:#ff3366;color:white;border:none;border-radius:20px;font-weight:900;margin-top:10px;">ДАЛЕЕ</button>
      </div>`,
      buttons: [{type:"close"}]
    });

    setTimeout(() => {
      document.getElementById('wNext').onclick = () => {
        const amount = parseInt(document.getElementById('wAmount').value || 0);
        if (amount < 100) return tg.showAlert("Минимум 100 ₽");
        if (amount > userBalance) return tg.showAlert("Недостаточно средств!");

        tg.showPopup({
          title: "Реквизиты",
          message: `<div style="padding:20px;">
            <input type="text" id="wName" placeholder="Имя / Ник" style="width:100%;padding:18px;margin:10px 0;background:#000;border:3px solid #ff3366;border-radius:20px;color:white;">
            <input type="text" id="wCard" placeholder="Карта / Телефон" style="width:100%;padding:18px;margin:10px 0;background:#000;border:3px solid #ff3366;border-radius:20px;color:white;">
            <input type="text" id="wBank" placeholder="Банк (если карта)" style="width:100%;padding:18px;margin:10px 0;background:#000;border:3px solid #ff3366;border-radius:20px;color:white;">
            <button onclick="tg.showConfirm('Вывести ${amount} ₽?', ok=>{if(ok){tg.showAlert('Заявка отправлена!'); userBalance-=amount; document.getElementById('user-balance').innerText=userBalance.toLocaleString()+' ₽';}})" 
                    style="margin-top:20px;width:100%;padding:20px;background:#ff3366;color:white;border:none;border-radius:20px;font-weight:900;">
              ОТПРАВИТЬ ЗАЯВКУ
            </button>
          </div>`,
          buttons: [{type:"close"}]
        });
      };
    }, 400);
  };

  // Остальное
  document.getElementById('create-task-btn').onclick = () => document.getElementById('create-form').classList.toggle('active');
  document.getElementById('task-type').onchange = updateBudgetInfo;
  document.getElementById('task-budget').oninput = () => setTimeout(updateBudgetInfo, 600);

  document.querySelectorAll('.price-btn').forEach(btn => {
    btn.onclick = () => {
      const val = parseInt(btn.dataset.amount);
      if (val <= 15000) document.getElementById('task-budget').value = val;
      document.querySelectorAll('.price-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      updateBudgetInfo();
    };
  });

  document.getElementById('publish-task').onclick = () => {
    const budget = parseInt(document.getElementById('task-budget').value);
    if (budget > 15000) return tg.showAlert("Максимум 15 000 ₽ за задание!");
    tg.showAlert("Задание успешно опубликовано!");
    document.getElementById('create-form').classList.remove('active');
  };

  document.querySelectorAll('.role-btn, .nav-btn, .filter-btn').forEach(btn => {
    btn.onclick = () => {
      btn.parentElement.querySelectorAll('.active').forEach(el => el.classList.remove('active'));
      btn.classList.add('active');
      if (btn.dataset.role) {
        document.getElementById('employer-mode').style.display = btn.dataset.role === 'employer' ? 'block' : 'none';
        document.getElementById('worker-mode').style.display = btn.dataset.role === 'worker' ? 'block' : 'none';
      }
      if (btn.dataset.page) {
        document.getElementById('main-page').style.display = btn.dataset.page === 'main' ? 'block' : 'none';
        document.getElementById('profile-page').style.display = btn.dataset.page === 'profile' ? 'block' : 'none';
      }
    };
  });

  function updateBudgetInfo() {
    const type = document.getElementById('task-type').value;
    const budget = Math.min(parseInt(document.getElementById('task-budget').value) || 0, 15000);
    if (!type || budget < minBudget[type]) {
      document.getElementById('budget-result').innerHTML = 'Выберите тип и сумму';
      return;
    }
    const count = Math.floor(budget / prices[type]);
    const real = count * prices[type];
    document.getElementById('budget-result').innerHTML = `За <b style="color:#00ff88;">${real} ₽</b> будет выполнено<br><b style="color:#ffd700;font-size:38px;">${count}</b> ${type==='telegram'?'подписок':'отзывов'}`;
  }
</script>
</body>
</html>
