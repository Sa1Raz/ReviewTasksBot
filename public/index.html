<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ReviewCash ‚Äî –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
<script src="https://unpkg.com/lottie-web@5.8.1/build/player/lottie.min.js"></script>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

<style>
/* ===========================
   Theme variables (light/dark) ‚Äî improved stability for light theme
   =========================== */
:root{
  --bg-1: #061426; /* dark primary */
  --bg-2: #031827;
  --card-bg: rgba(255,255,255,0.03);
  --glass: rgba(255,255,255,0.04);
  --muted: #9fb6c6;
  --accentA: #00c7d7;
  --accentB: #00e08a;
  --neon: rgba(0,200,255,0.12);
  --radius: 14px;
  --text: #eaf7fb;
  --shadow-1: 0 8px 24px rgba(0,0,0,0.35);
}
:root[data-theme="light"]{
  --bg-1: #f4f7fb; /* light primary ‚Äî more neutral, stable contrast */
  --bg-2: #eef4fa;
  --card-bg: rgba(255,255,255,0.98);
  --glass: rgba(12,20,28,0.06);
  --muted: #5b6b76;
  --text: #071426;
  --accentA: #0079c8;
  --accentB: #00a86b;
  --neon: rgba(0,120,255,0.06);
  --shadow-1: 0 8px 24px rgba(2,8,20,0.06);
}

/* Base */
*{box-sizing:border-box}
html{scroll-behavior:smooth}
body{
  margin:0;font-family:Inter,system-ui,Arial;background:linear-gradient(180deg,var(--bg-1),var(--bg-2));color:var(--text);
  -webkit-font-smoothing:antialiased;
}

/* Layout */
.app{max-width:1100px;margin:20px auto;padding:16px;display:grid;grid-template-columns:1fr 360px;gap:18px;align-items:start}
.header{grid-column:1/-1;display:flex;align-items:center;gap:12px}
.logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,var(--accentA),var(--accentB));display:flex;align-items:center;justify-content:center;color:#012226;font-weight:900}
.title h1{margin:0;font-size:20px}
.title p{margin:0;color:var(--muted);font-size:13px}
.header-actions{margin-left:auto;display:flex;gap:8px}

/* Panels */
.panel{background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent);border-radius:12px;padding:14px;border:1px solid var(--glass);box-shadow:var(--shadow-1);transition:transform .28s,box-shadow .28s}
.panel:hover{transform:translateY(-6px)}

.tasks-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px;margin-top:12px}

/* Task */
.task{padding:12px;border-radius:12px;background:var(--card-bg);border:1px solid rgba(0,0,0,0.04);cursor:pointer;transition:transform .22s,box-shadow .22s}
.task:hover{transform:translateY(-8px) scale(1.02);box-shadow:0 24px 60px rgba(0,0,0,0.45)}
.task .title{font-weight:700}
.task .meta{color:var(--muted);font-size:13px}

/* Buttons */
.btn{padding:10px 12px;border-radius:12px;border:none;background:linear-gradient(90deg,var(--accentA),var(--accentB));color:#012226;font-weight:700;cursor:pointer;transition:transform .12s,box-shadow .12s}
.btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--text);padding:8px;border-radius:10px}

/* Bottom nav */
.bottom-nav{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;width:360px;max-width:94%;height:68px;border-radius:14px;display:flex;align-items:center;justify-content:space-around;gap:8px;padding:8px;background:linear-gradient(180deg, rgba(0,0,0,0.18), rgba(0,0,0,0.12));border:1px solid rgba(255,255,255,0.03);box-shadow:0 18px 60px rgba(0,0,0,0.5);z-index:2000}
.nav-button{display:flex;flex-direction:column;align-items:center;gap:6px;color:var(--muted);cursor:pointer;padding:6px;border-radius:10px;transition:all .25s}
.nav-button.active{color:var(--accentA);transform:translateY(-6px);background:linear-gradient(90deg,rgba(0,200,255,0.05),rgba(0,200,140,0.02))}

/* Modal for create task */
.modal-backdrop{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);align-items:center;justify-content:center;z-index:3000}
.modal{background:linear-gradient(180deg,#061426,#041726);padding:16px;border-radius:12px;width:720px;max-width:94%;border:1px solid rgba(255,255,255,0.04)}
.input{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text)}

/* Skeleton */
.skeleton{height:12px;border-radius:8px;background:linear-gradient(90deg,#ffffff06,#ffffff02,#ffffff06);animation: pulse 1.6s infinite}
@keyframes pulse{0%{opacity:.6}50%{opacity:1}100%{opacity:.6}}

/* Parallax */
.parallax{position:fixed;inset:0;pointer-events:none;z-index:-1}
.blob{position:absolute;border-radius:50%;filter:blur(30px) saturate(120%);opacity:.12}

/* Responsive adjustments */
@media(max-width:1000px){ .app{grid-template-columns:1fr;padding-bottom:100px} .bottom-nav{display:flex} }
@media(min-width:1001px){ .bottom-nav{display:none} }

/* Accessibility */
button:focus{outline:2px dashed var(--accentA);outline-offset:4px}
</style>
</head>
<body>
  <div class="parallax" id="parallax">
    <div class="blob" id="b1" style="left:-220px;top:-220px;width:800px;height:800px;background:radial-gradient(circle at 30% 30%, var(--accentA), transparent 30%);"></div>
    <div class="blob" id="b2" style="right:-260px;bottom:-240px;width:600px;height:600px;background:radial-gradient(circle at 70% 70%, var(--accentB), transparent 30%);"></div>
  </div>

  <div class="app" id="app">
    <div class="header">
      <div class="logo">RC</div>
      <div class="title"><h1>ReviewCash</h1><p>–ó–∞–¥–∞–Ω–∏—è –∏ –ø—Ä–æ—Ñ–∏–ª—å ‚Äî —Ç–µ–ø–µ—Ä—å —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º –∑–∞–¥–∞—á</p></div>
      <div class="header-actions">
        <button id="createTaskBtn" class="btn" title="–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É" style="display:none">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</button>
        <button id="themeToggle" class="btn-ghost">–¢–µ–º–∞</button>
      </div>
    </div>

    <main id="tasksView" class="panel" aria-live="polite">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div><h2 style="margin:0">–ó–∞–¥–∞–Ω–∏—è</h2><div class="muted">–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–¥–∞—á</div></div>
        <div style="display:flex;gap:8px;align-items:center">
          <input id="search" placeholder="–ü–æ–∏—Å–∫..." class="input" style="max-width:220px"/>
          <button id="refresh" class="btn">–û–±–Ω–æ–≤–∏—Ç—å</button>
        </div>
      </div>
      <div id="tasksGrid" class="tasks-grid">
        <div><div class="task skeleton" style="height:84px"></div></div>
        <div><div class="task skeleton" style="height:84px"></div></div>
        <div><div class="task skeleton" style="height:84px"></div></div>
      </div>
    </main>

    <aside id="profileView" class="panel">
      <div style="display:flex;gap:12px;align-items:center;justify-content:space-between">
        <div style="display:flex;gap:12px;align-items:center">
          <div id="avatar" style="width:72px;height:72px;border-radius:12px;background:linear-gradient(135deg,#04202a,#05202a);display:flex;align-items:center;justify-content:center;font-weight:800">RC</div>
          <div>
            <div id="fullname" style="font-weight:800">–ü—Ä–æ—Ñ–∏–ª—å —Å–∫—Ä—ã—Ç</div>
            <div id="handle" class="muted">–ù–∞–∂–º–∏—Ç–µ –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</div>
            <div style="margin-top:8px"><button id="revealProfile" class="btn-ghost">–ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button></div>
          </div>
        </div>
        <div><button id="supportBtn" class="btn-ghost">üéß</button></div>
      </div>
      <div style="margin-top:12px">
        <h3 style="margin:6px 0">–ò—Å—Ç–æ—Ä–∏—è</h3>
        <div id="history" style="max-height:260px;overflow:auto"><div class="muted">–°–∫—Ä—ã—Ç–æ</div></div>
      </div>
      <div style="margin-top:12px;display:flex;gap:8px">
        <button id="topupBtn" class="btn">–ü–æ–ø–æ–ª–Ω–∏—Ç—å</button>
        <button id="withdrawBtn" class="btn-ghost">–í—ã–≤–µ—Å—Ç–∏</button>
      </div>
    </aside>
  </div>

  <!-- Bottom nav (mobile) -->
  <nav class="bottom-nav" id="bottomNav">
    <div class="nav-button active" id="navTasks" data-view="tasks"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><rect x="9" y="2" width="6" height="4" rx="1" stroke="currentColor" stroke-width="1.4"/><path d="M7 8h10v12a1 1 0 0 1-1 1H8a1 1 0 0 1-1-1V8z" stroke="currentColor" stroke-width="1.4"/></svg><div style="font-size:13px">–ó–∞–¥–∞–Ω–∏—è</div></div>
    <div class="nav-button" id="navProfile" data-view="profile"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="1.4"/><circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="1.4"/></svg><div style="font-size:13px">–ü—Ä–æ—Ñ–∏–ª—å</div></div>
  </nav>

  <!-- Create Task modal -->
  <div id="createModal" class="modal-backdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <strong>–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</strong>
        <button id="closeCreate" class="btn-ghost">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
      <div style="margin-top:10px">
        <label>–ù–∞–∑–≤–∞–Ω–∏–µ</label>
        <input id="taskTitle" class="input" placeholder="–ö–æ—Ä–æ—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ"/>
      </div>
      <div style="margin-top:8px">
        <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
        <textarea id="taskDesc" class="input" style="min-height:100px"></textarea>
      </div>
      <div style="margin-top:8px;display:flex;gap:8px">
        <input id="taskLink" class="input" placeholder="–°—Å—ã–ª–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)" />
        <input id="taskBudget" class="input" placeholder="–ë—é–¥–∂–µ—Ç ‚ÇΩ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)" style="max-width:160px"/>
      </div>
      <div style="margin-top:12px;display:flex;gap:8px;justify-content:flex-end">
        <button id="submitTask" class="btn">–°–æ–∑–¥–∞—Ç—å</button>
        <button id="cancelCreate" class="btn-ghost">–û—Ç–º–µ–Ω–∞</button>
      </div>
      <div id="createFeedback" style="margin-top:8px;color:var(--muted)"></div>
    </div>
  </div>

<script>
/* ----------------
   Helpers
   ---------------- */
function sleep(ms){ return new Promise(r=>setTimeout(r, ms)); }
function escapeHtml(s){ return String(s||'').replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }
function qs(name){ return new URLSearchParams(location.search).get(name); }
const adminToken = qs('token') || '';

/* ----------------
   Theme
   ---------------- */
(function(){
  const root = document.documentElement;
  const stored = localStorage.getItem('rc_theme');
  if(stored) root.setAttribute('data-theme', stored);
  else if(window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) root.setAttribute('data-theme','light');
  document.getElementById('themeToggle').addEventListener('click', ()=>{
    const cur = root.getAttribute('data-theme');
    const next = (cur === 'light') ? null : 'light';
    if(next) root.setAttribute('data-theme', next), localStorage.setItem('rc_theme', next);
    else root.removeAttribute('data-theme'), localStorage.removeItem('rc_theme');
  });
})();

/* ----------------
   Parallax
   ---------------- */
(function(){
  const blob1 = document.getElementById('b1');
  const blob2 = document.getElementById('b2');
  document.addEventListener('mousemove', e=>{
    const cx = e.clientX - window.innerWidth/2;
    const cy = e.clientY - window.innerHeight/2;
    if(blob1) blob1.style.transform = `translate(${cx*0.02}px, ${cy*0.02}px)`;
    if(blob2) blob2.style.transform = `translate(${cx*-0.03}px, ${cy*-0.03}px)`;
  });
  window.addEventListener('scroll', ()=>{ const s=window.scrollY; const p=document.getElementById('parallax'); if(p) p.style.transform=`translateY(${s*0.06}px)`; }, {passive:true});
})();

/* ----------------
   Tasks loading (progressive)
   ---------------- */
async function loadTasks(){
  const grid = document.getElementById('tasksGrid');
  grid.innerHTML = '';
  for(let i=0;i<6;i++){ const sk=document.createElement('div'); sk.innerHTML='<div class="task skeleton" style="height:84px"></div>'; grid.appendChild(sk); }
  try {
    const res = await fetch('/api/tasks_public');
    const tasks = await res.json();
    grid.innerHTML = '';
    if(!Array.isArray(tasks) || tasks.length === 0){ grid.innerHTML = '<div class="muted">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π</div>'; return; }
    for(let t of tasks){
      const el = document.createElement('div'); el.className='fadeIn';
      el.innerHTML = `<div class="task"><div class="title">${escapeHtml(t.title||t.id)}</div><div class="meta">${escapeHtml(t.description||'')}</div><div style="margin-top:8px;color:var(--muted)">${t.budget? t.budget+' ‚ÇΩ':''} ${t.link? '‚Ä¢ '+escapeHtml(t.link):''}</div></div>`;
      grid.appendChild(el);
      el.querySelector('.task').addEventListener('click', ()=> alert('–û—Ç–∫—Ä—ã—Ç–æ: '+(t.title||t.id)));
      await sleep(40);
    }
  } catch(e){ console.error(e); grid.innerHTML = '<div class="muted">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</div>'; }
}

/* ----------------
   Bottom nav (mobile)
   ---------------- */
(function(){
  const navTasks = document.getElementById('navTasks'), navProfile = document.getElementById('navProfile'), tasksView=document.getElementById('tasksView'), profileView=document.getElementById('profileView');
  function setActive(view){
    if(window.innerWidth > 1000){ tasksView.style.display=''; profileView.style.display=''; navTasks.classList.remove('active'); navProfile.classList.remove('active'); return; }
    if(view==='tasks'){ tasksView.style.display=''; profileView.style.display='none'; navTasks.classList.add('active'); navProfile.classList.remove('active'); }
    else { profileView.style.display=''; tasksView.style.display='none'; navProfile.classList.add('active'); navTasks.classList.remove('active'); }
  }
  navTasks.addEventListener('click', ()=> setActive('tasks'));
  navProfile.addEventListener('click', ()=> setActive('profile'));
  window.addEventListener('resize', ()=> { if(window.innerWidth>1000){ tasksView.style.display=''; profileView.style.display=''; } else setActive('tasks'); });
  if(window.innerWidth<=1000) setActive('tasks');
})();

/* ----------------
   Create Task (UI + API call)
   - Button is shown only when admin token present in URL
   ---------------- */
(function(){
  const createBtn = document.getElementById('createTaskBtn');
  const modal = document.getElementById('createModal');
  const closeBtn = document.getElementById('closeCreate');
  const cancelBtn = document.getElementById('cancelCreate');
  const submitBtn = document.getElementById('submitTask');
  const feedback = document.getElementById('createFeedback');

  function showModal(){ modal.style.display = 'flex'; modal.setAttribute('aria-hidden','false'); feedback.textContent=''; }
  function hideModal(){ modal.style.display = 'none'; modal.setAttribute('aria-hidden','true'); }

  if(adminToken){
    createBtn.style.display = '';
    createBtn.addEventListener('click', showModal);
    closeBtn.addEventListener('click', hideModal);
    cancelBtn.addEventListener('click', hideModal);
    submitBtn.addEventListener('click', async ()=>{
      const title = document.getElementById('taskTitle').value.trim();
      const desc = document.getElementById('taskDesc').value.trim();
      const link = document.getElementById('taskLink').value.trim();
      const budget = document.getElementById('taskBudget').value.trim();
      if(!title){ feedback.textContent='–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏'; return; }
      feedback.textContent = '–°–æ–∑–¥–∞—é –∑–∞–¥–∞—á—É...';
      try {
        const res = await fetch('/api/tasks_create?token='+encodeURIComponent(adminToken), { method:'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({ title, description: desc, link, budget })});
        const j = await res.json();
        if(!j.ok){ feedback.textContent = '–û—à–∏–±–∫–∞: ' + (j.reason||''); return; }
        feedback.textContent = '–ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞';
        hideModal();
        loadTasks(); // reload
      } catch(e){ feedback.textContent = '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏'; console.error(e); }
    });
  } else {
    createBtn.style.display = 'none';
  }
})();

/* ----------------
   Profile reveal
   ---------------- */
document.getElementById('revealProfile').addEventListener('click', async ()=>{
  try {
    const tgInit = window.Telegram && Telegram.WebApp && Telegram.WebApp.initData ? Telegram.WebApp.initData : null;
    if(!tgInit){ document.getElementById('fullname').textContent='–ì–æ—Å—Ç—å'; document.getElementById('handle').textContent='–ü—Ä–æ—Ñ–∏–ª—å –æ—Ç–∫—Ä—ã—Ç –ª–æ–∫–∞–ª—å–Ω–æ'; return; }
    const res = await fetch('/api/profile_me', { headers: { 'X-Tg-InitData': tgInit } });
    const j = await res.json();
    if(!j.ok){ alert('–û—à–∏–±–∫–∞: '+(j.reason||'')); return; }
    document.getElementById('fullname').textContent = j.user.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
    document.getElementById('handle').textContent = j.user.username ? '@'+j.user.username : 'UID: '+j.user.id;
    if(j.photo_url){ const av=document.getElementById('avatar'); av.innerHTML=''; const img=document.createElement('img'); img.src=j.photo_url; img.style.width='72px'; img.style.height='72px'; img.style.borderRadius='12px'; av.appendChild(img); }
    // load history
    const uid = j.user.id;
    const list = document.getElementById('history'); list.innerHTML='';
    const res2 = await fetch(`/api/user_history?uid=${encodeURIComponent(uid)}&page=1&page_size=6`);
    const j2 = await res2.json();
    if(!j2.ok || !j2.items || j2.items.length===0) { list.innerHTML='<div class="muted">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</div>'; return; }
    for(let it of j2.items){
      const row = document.createElement('div'); row.style.display='flex'; row.style.justifyContent='space-between'; row.style.padding='8px 0'; row.style.borderBottom='1px dashed rgba(0,0,0,0.06)';
      row.innerHTML = `<div><div style="font-weight:700">${escapeHtml((it.type||'').toUpperCase())} ‚Äî ${escapeHtml(it.id||'')}</div><div class="muted" style="font-size:13px">${escapeHtml(it.summary||'')}</div></div><div style="text-align:right"><div style="font-weight:800">${it.amount? it.amount+' ‚ÇΩ': ''}</div><div class="muted" style="font-size:12px">${escapeHtml(it.created_at||'')}</div></div>`;
      list.appendChild(row);
    }
  } catch(e){ console.error(e); alert('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è'); }
});

/* ----------------
   socket.io - listen for new_task and refresh
   ---------------- */
try {
  const sock = io();
  sock.on('connect', ()=> console.log('socket connected'));
  sock.on('new_task', ()=> loadTasks());
} catch(e){ console.warn('socket fail', e); }

/* ----------------
   Topup/Withdraw/Support (simple)
   ---------------- */
document.getElementById('topupBtn').addEventListener('click', async ()=>{
  const s=prompt('–°—É–º–º–∞ (–º–∏–Ω.100 ‚ÇΩ):'); if(!s) return;
  const amount=parseFloat(s.replace(',','.')); if(isNaN(amount)||amount<100){ alert('–ú–∏–Ω.100 ‚ÇΩ'); return; }
  try {
    const headers = {'Content-Type':'application/json'}; if(window.Telegram && Telegram.WebApp && Telegram.WebApp.initData) headers['X-Tg-InitData']=Telegram.WebApp.initData;
    const res = await fetch('/api/topups_public', { method:'POST', headers, body: JSON.stringify({ amount })});
    const j = await res.json();
    if(!j.ok) alert('–û—à–∏–±–∫–∞: '+(j.reason||'')); else alert(`–ö–æ–¥: ${j.topup.code}. –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ ${amount} ‚ÇΩ –Ω–∞ ${j.bank.phone}`);
    loadTasks();
  } catch(e){ alert('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏'); }
});

document.getElementById('withdrawBtn').addEventListener('click', async ()=>{
  const s=prompt('–°—É–º–º–∞ (–º–∏–Ω.250 ‚ÇΩ):'); if(!s) return;
  const amount=parseFloat(s.replace(',','.')); if(isNaN(amount)||amount<250){ alert('–ú–∏–Ω.250 ‚ÇΩ'); return; }
  const name=prompt('–§–ò–û/–Ω–∏–∫:'); if(!name) return;
  const bank=prompt('–ë–∞–Ω–∫/—Ä–µ–∫–≤–∏–∑–∏—Ç—ã:'); if(!bank) return;
  try {
    const headers={'Content-Type':'application/json'}; if(window.Telegram && Telegram.WebApp && Telegram.WebApp.initData) headers['X-Tg-InitData']=Telegram.WebApp.initData;
    const res = await fetch('/api/withdraw_public', { method:'POST', headers, body: JSON.stringify({ amount, name, bank })});
    const j = await res.json();
    if(!j.ok){ if(j.reason==='insufficient_balance') alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤: '+(j.balance||0)); else alert('–û—à–∏–±–∫–∞: '+(j.reason||'')); return; }
    alert('–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞. –í —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤.');
  } catch(e){ alert('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏'); }
});

/* ----------------
   Init
   ---------------- */
document.getElementById('refresh').addEventListener('click', ()=> loadTasks());
loadTasks();
</script>
</body>
</html>
