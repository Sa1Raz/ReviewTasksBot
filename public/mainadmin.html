<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ГЛАВНЫЙ АДМИН | ReviewCash</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
  <style>
    body { background: linear-gradient(135deg, #000, #1a0033); color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; min-height: 100vh; }
    .header { text-align: center; padding: 20px; background: linear-gradient(90deg, #ffd700, #ff6b00); color: #000; font-size: 28px; font-weight: 900; border-radius: 20px; margin-bottom: 20px; }
    .card { background: rgba(30,0,70,0.8); border: 3px solid #ffd700; border-radius: 20px; padding: 20px; margin: 15px 0; backdrop-filter: blur(15px); }
    .stat { font-size: 24px; text-align: center; margin: 15px 0; }
    .stat span { color: #00ffff; font-size: 32px; font-weight: 900; }
    .btn { width: 100%; padding: 18px; margin: 10px 0; border: none; border-radius: 20px; font-weight: 900; font-size: 18px; cursor: pointer; }
    .btn-gold { background: linear-gradient(45deg, #ffd700, #ff8c00); color: #000; }
    .btn-red { background: #ff3366; color: white; }
    .item { background: rgba(0,255,255,0.1); padding: 15px; border-radius: 15px; margin: 10px 0; border-left: 5px solid #00ffff; }
    .item.new { animation: pulse 2s infinite; border-left-color: #ffd700; }
    @keyframes pulse { 0%,100% { box-shadow: 0 0 20px #ffd700; } 50% { box-shadow: 0 0 40px #ffd700; } }
  </style>
</head>
<body>
  <div class="header">
    ГЛАВНЫЙ АДМИН<br><small>Только для Раяза Н.</small>
  </div>

  <div class="card">
    <div class="stat">Пользователей: <span id="users">0</span></div>
    <div class="stat">Заданий: <span id="tasks-total">0</span></div>
    <div class="stat">Выполнено: <span id="tasks-done">0</span></div>
    <div class="stat">Баланс системы: <span id="balance">0 ₽</span></div>
  </div>

  <div class="card">
    <h2 style="text-align:center;color:#ffd700;">Пополнения</h2>
    <div id="topups"></div>
  </div>

  <div class="card">
    <h2 style="text-align:center;color:#ff3366;">Выводы</h2>
    <div id="withdraws"></div>
  </div>

  <button class="btn btn-gold" onclick="location.reload()">ОБНОВИТЬ</button>
  <button class="btn btn-red" onclick="window.close()">ВЫХОД</button>

  <script>
    const tg = window.Telegram.WebApp;
    const user = tg.initDataUnsafe.user || {};

    // Только ты можешь быть здесь
    if (user.id !== 759109343) {
      document.body.innerHTML = '<h1 style="text-align:center;color:#ff3366;padding:100px;">ДОСТУП ЗАПРЕЩЁН</h1>';
      return;
    }

    function load() {
      fetch('https://твой-бэкенд.ру/api/admin_full.php') // ← твой API
        .then(r => r.json())
        .then(d => {
          document.getElementById('users').innerText = d.stats.users;
          document.getElementById('tasks-total').innerText = d.stats.tasks;
          document.getElementById('tasks-done').innerText = d.stats.done;
          document.getElementById('balance').innerText = d.stats.balance + ' ₽';

          let t = '', w = '';
          d.topups.forEach(x => {
            t += `<div class="item ${x.status==='new'?'new':''}">
              <b>${x.amount} ₽</b> от @${x.username}<br>
              Код: ${x.code} | ${new Date(x.time).toLocaleString()}
              ${x.status==='new' ? ' <button onclick="pay(${x.id},'topup')">ЗАЧИСЛИТЬ</button>' : 'Зачислено'}
            </div>`;
          });
          d.withdraws.forEach(x => {
            w += `<div class="item ${x.status==='new'?'new':''}">
              <b>${x.amount} ₽</b> → ${x.card}<br>
              @${x.username} | ${x.status}
              ${x.status==='new' ? ' <button onclick="pay(${x.id},\'withdraw\')">ВЫПЛАТИТЬ</button> <button style="background:#ff3366;" onclick="reject(${x.id})">ОТКЛОНИТЬ</button>' : ''}
            </div>`;
          });
          document.getElementById('topups').innerHTML = t || 'Нет заявок';
          document.getElementById('withdraws').innerHTML = w || 'Нет заявок';
        });
    }

    function pay(id, type) {
      if(confirm('Подтвердить?')) {
        fetch(`https://твой-бэкенд.ру/api/action.php?id=${id}&type=${type}&act=confirm`);
        setTimeout(load, 1000);
      }
    }
    function reject(id) {
      if(confirm('Отклонить?')) {
        fetch(`https://твой-бэкенд.ру/api/action.php?id=${id}&type=withdraw&act=reject`);
        setTimeout(load, 1000);
      }
    }

    load();
    setInterval(load, 4000);
  </script>
</body>
</html>
